\hypertarget{common_2measurement_8c}{\section{src/fca/common/measurement.c \-File \-Reference}
\label{common_2measurement_8c}\index{src/fca/common/measurement.\-c@{src/fca/common/measurement.\-c}}
}


measurement.\-c, (c) 2013, \-Immanuel \-Albrecht; \-Dresden \-University of \-Technology, \-Professur für die \-Psychologie des \-Lernen und \-Lehrens  


{\ttfamily \#include $<$math.\-h$>$}\*
{\ttfamily \#include $<$string.\-h$>$}\*
{\ttfamily \#include \char`\"{}../common.\-h\char`\"{}}\*
\-Include dependency graph for measurement.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{common_2measurement_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{common_2measurement_8h_ab2406aaef0ce3e9f38a79f42ce470ffb}{\-Eta\-Function} \hyperlink{common_2measurement_8c_aa0f12091b86c478e159761719923bd9a}{new\-Eta\-Function} (size\-\_\-t types, size\-\_\-t measurements, size\-\_\-t constants)
\begin{DoxyCompactList}\small\item\em creates a new \-Eta\-Function \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_a2905b59d4a364111890224a444fd6d30}{delete\-Eta\-Function} (\hyperlink{common_2measurement_8h_ab2406aaef0ce3e9f38a79f42ce470ffb}{\-Eta\-Function} $\ast$eta)
\begin{DoxyCompactList}\small\item\em deletes an \-Eta\-Function and sets the pointer to zero \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_ab2406aaef0ce3e9f38a79f42ce470ffb}{\-Eta\-Function} \hyperlink{common_2measurement_8c_a48c795067056a496c8e4aa903fac7d71}{new\-Uniform\-Eta\-Function} (size\-\_\-t types, size\-\_\-t measurements)
\begin{DoxyCompactList}\small\item\em create a new \-Eta\-Function with the same constant for each type \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_ab2406aaef0ce3e9f38a79f42ce470ffb}{\-Eta\-Function} \hyperlink{common_2measurement_8c_a018a3a7d15c126cbf15d03ba2698fe39}{new\-General\-Eta\-Function} (size\-\_\-t types, size\-\_\-t measurements)
\begin{DoxyCompactList}\small\item\em create a new \-Eta\-Function with the a constant for each type and measurement on its own \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_afb8ffb8c068ef8c9fa3677762ac85994}{\-Commutative\-Product} \hyperlink{common_2measurement_8c_abe35a2e2ccf6060635d4daf6d6ebf59e}{new\-Commutative\-Product} (size\-\_\-t constants)
\begin{DoxyCompactList}\small\item\em creates a new commutative product without any factors \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_a2120fbc047167fd0a08f3015b8716cd1}{delete\-Commutative\-Product} (\hyperlink{common_2measurement_8h_afb8ffb8c068ef8c9fa3677762ac85994}{\-Commutative\-Product} $\ast$p)
\begin{DoxyCompactList}\small\item\em deletes a \-Commutative\-Product and sets its pointer to zero. \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_ab2f71cb9d9b10edcc10d44f79ee40d10}{\-Condition\-Map} \hyperlink{common_2measurement_8c_ac4b7705e5a5c82b5d59b67617e6f2dc4}{new\-Condition\-Map} (size\-\_\-t objects)
\begin{DoxyCompactList}\small\item\em creates a new condition map \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_ad40c601ad1dcd904cde0e9ebe2828d72}{delete\-Condition\-Map} (\hyperlink{common_2measurement_8h_ab2f71cb9d9b10edcc10d44f79ee40d10}{\-Condition\-Map} $\ast$c)
\begin{DoxyCompactList}\small\item\em deletes a \-Condition\-Map object \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_ace94e4c4dddc7766492a0f041a72963b}{\-Log\-Cache} \hyperlink{common_2measurement_8c_a25fcd9b89607eaa3abe03aea6ffe0447}{new\-Log\-Cache} (size\-\_\-t constants)
\begin{DoxyCompactList}\small\item\em creates a new cache for logs of constants \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_ae9d17380c2a4280b6760d9d917dfb573}{delete\-Log\-Cache} (\hyperlink{common_2measurement_8h_ace94e4c4dddc7766492a0f041a72963b}{\-Log\-Cache} $\ast$log\-\_\-c)
\begin{DoxyCompactList}\small\item\em deletes a \-Log\-Cache and sets its pointer to zero \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_aea95ce7469fb27ec5a2fa98d099df572}{calculate\-Logs} (const \hyperlink{common_2measurement_8h_ab2406aaef0ce3e9f38a79f42ce470ffb}{\-Eta\-Function} eta, \hyperlink{common_2measurement_8h_ace94e4c4dddc7766492a0f041a72963b}{\-Log\-Cache} log\-\_\-c)
\begin{DoxyCompactList}\small\item\em calculates the logarithms of probabilities given by constants, and their complements \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_a0a02860cc83aa9ce63d00855bc9058e0}{\-Log\-Probability} \hyperlink{common_2measurement_8c_a8df411530d5811c51cb675a64547eed9}{log\-Probability\-From\-Product} (const \hyperlink{common_2measurement_8h_ace94e4c4dddc7766492a0f041a72963b}{\-Log\-Cache} log\-\_\-c, \hyperlink{common_2measurement_8h_afb8ffb8c068ef8c9fa3677762ac85994}{\-Commutative\-Product} l)
\begin{DoxyCompactList}\small\item\em calculate the log probability from a power vector \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_a0a02860cc83aa9ce63d00855bc9058e0}{\-Log\-Probability} \hyperlink{common_2measurement_8c_a6ec39ef8a7180bc340afed87c57ca604}{sum\-Up} (const \hyperlink{common_2measurement_8h_a0a02860cc83aa9ce63d00855bc9058e0}{\-Log\-Probability} $\ast$restrict \-V, size\-\_\-t length, \hyperlink{common_2measurement_8h_a0a02860cc83aa9ce63d00855bc9058e0}{\-Log\-Probability} lower\-\_\-bound, \hyperlink{common_2measurement_8h_a0a02860cc83aa9ce63d00855bc9058e0}{\-Log\-Probability} upper\-\_\-bound)
\begin{DoxyCompactList}\small\item\em \-This routine calculates the sum of elements of a vector. \end{DoxyCompactList}\item 
\hyperlink{common_2measurement_8h_a315318def4482768da7077f76ff0c768}{\-Distance\-Matrix} \hyperlink{common_2measurement_8c_ae6570aaa925f8a9155f9385de467dcbd}{new\-Distance\-Matrix} (size\-\_\-t objects)
\begin{DoxyCompactList}\small\item\em creates a new \-Distance\-Matrix of the given size \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_a573c3990ed39b5ca911c9ef448f74703}{delete\-Distance\-Matrix} (\hyperlink{common_2measurement_8h_a315318def4482768da7077f76ff0c768}{\-Distance\-Matrix} $\ast$d)
\begin{DoxyCompactList}\small\item\em deletes the given object and sets its pointer to zero \end{DoxyCompactList}\item 
void \hyperlink{common_2measurement_8c_ad54d95f7de71efa2ad16ce6b133cf439}{write\-Distances\-To\-File} (const \hyperlink{common_2measurement_8h_a315318def4482768da7077f76ff0c768}{\-Distance\-Matrix} d, const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em \-Writes the contents of a distance matrix to the given file in \-C\-S\-V format\-: d(x,y) will be written on the (x+1)th line to the (y+1)th column. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
measurement.\-c, (c) 2013, \-Immanuel \-Albrecht; \-Dresden \-University of \-Technology, \-Professur für die \-Psychologie des \-Lernen und \-Lehrens \-This program is free software\-: you can redistribute it and/or modify it under the terms of the \-G\-N\-U \-General \-Public \-License as published by the \-Free \-Software \-Foundation, either version 3 of the \-License, or (at your option) any later version.

\-This program is distributed in the hope that it will be useful, but \-W\-I\-T\-H\-O\-U\-T \-A\-N\-Y \-W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of \-M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or \-F\-I\-T\-N\-E\-S\-S \-F\-O\-R \-A \-P\-A\-R\-T\-I\-C\-U\-L\-A\-R \-P\-U\-R\-P\-O\-S\-E. \-See the \-G\-N\-U \-General \-Public \-License for more details.

\-You should have received a copy of the \-G\-N\-U \-General \-Public \-License along with this program. \-If not, see $<$\href{http://www.gnu.org/licenses/}{\tt http\-://www.\-gnu.\-org/licenses/}$>$. \-This file contains implementations regarding measurement error probabilities related structures operations 

\-Definition in file \hyperlink{common_2measurement_8c_source}{measurement.\-c}.



\subsection{\-Function \-Documentation}
\hypertarget{common_2measurement_8c_aea95ce7469fb27ec5a2fa98d099df572}{\index{common/measurement.\-c@{common/measurement.\-c}!calculate\-Logs@{calculate\-Logs}}
\index{calculate\-Logs@{calculate\-Logs}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{calculate\-Logs}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf calculate\-Logs} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Eta\-Function}}]{eta, }
\item[{{\bf \-Log\-Cache}}]{log\-\_\-c}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_aea95ce7469fb27ec5a2fa98d099df572}


calculates the logarithms of probabilities given by constants, and their complements 


\begin{DoxyParams}{\-Parameters}
{\em eta} & input constants \\
\hline
{\em log\-\_\-c} & output structure to update the constants \\
\hline
\end{DoxyParams}


\-Definition at line 239 of file measurement.\-c.



\-References s\-Eta\-Function\-::\-C, s\-Eta\-Function\-::constants, s\-Log\-Cache\-::constants, s\-Log\-Cache\-::log\-C, s\-Log\-Cache\-::log\-Not\-C, and \-W\-A\-R\-N\-\_\-\-I\-F\-\_\-\-U\-N\-E\-Q\-U\-A\-L\-\_\-\-D\-O.



\-Referenced by main().


\begin{DoxyCode}
{
    WARN_IF_UNEQUAL_DO(eta->constants, log_c->constants, return);

    /*
     * we could use just any logarithm, so 2 seems reasonable...
     */

    for (size_t i = 0; i < eta->constants; ++i)
    {
        log_c->logC[i] = log2(eta->C[i]);
        log_c->logNotC[i] = log2(1. - eta->C[i]);
    }
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_a2120fbc047167fd0a08f3015b8716cd1}{\index{common/measurement.\-c@{common/measurement.\-c}!delete\-Commutative\-Product@{delete\-Commutative\-Product}}
\index{delete\-Commutative\-Product@{delete\-Commutative\-Product}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{delete\-Commutative\-Product}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf delete\-Commutative\-Product} (
\begin{DoxyParamCaption}
\item[{{\bf \-Commutative\-Product} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a2120fbc047167fd0a08f3015b8716cd1}


deletes a \-Commutative\-Product and sets its pointer to zero. 


\begin{DoxyParams}{\-Parameters}
{\em p} & \\
\hline
\end{DoxyParams}


\-Definition at line 149 of file measurement.\-c.



\-References \-R\-E\-T\-U\-R\-N\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O.



\-Referenced by new\-Distance\-Matrix\-From\-Context(), optimize\-Approximation\-Context(), and optimize\-Condition\-Map().


\begin{DoxyCode}
{
    RETURN_IF_ZERO(p);
    RETURN_IF_ZERO(*p);

    free((*p)->match);
    free((*p)->mismatch);
    free((*p)->intermediate);
    free(*p);

    *p = 0;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_ad40c601ad1dcd904cde0e9ebe2828d72}{\index{common/measurement.\-c@{common/measurement.\-c}!delete\-Condition\-Map@{delete\-Condition\-Map}}
\index{delete\-Condition\-Map@{delete\-Condition\-Map}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{delete\-Condition\-Map}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf delete\-Condition\-Map} (
\begin{DoxyParamCaption}
\item[{{\bf \-Condition\-Map} $\ast$}]{c}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_ad40c601ad1dcd904cde0e9ebe2828d72}


deletes a \-Condition\-Map object 


\begin{DoxyParams}{\-Parameters}
{\em c} & \\
\hline
\end{DoxyParams}


\-Definition at line 186 of file measurement.\-c.



\-References \-R\-E\-T\-U\-R\-N\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O.



\-Referenced by main().


\begin{DoxyCode}
{
    RETURN_IF_ZERO(c);
    RETURN_IF_ZERO(*c);

    free((*c)->c);
    free(*c);

    *c = 0;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_a573c3990ed39b5ca911c9ef448f74703}{\index{common/measurement.\-c@{common/measurement.\-c}!delete\-Distance\-Matrix@{delete\-Distance\-Matrix}}
\index{delete\-Distance\-Matrix@{delete\-Distance\-Matrix}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{delete\-Distance\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf delete\-Distance\-Matrix} (
\begin{DoxyParamCaption}
\item[{{\bf \-Distance\-Matrix} $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a573c3990ed39b5ca911c9ef448f74703}


deletes the given object and sets its pointer to zero 


\begin{DoxyParams}{\-Parameters}
{\em d} & \-Distance\-Matrix \\
\hline
\end{DoxyParams}


\-Definition at line 357 of file measurement.\-c.



\-References \-R\-E\-T\-U\-R\-N\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O.



\-Referenced by main().


\begin{DoxyCode}
{
    RETURN_IF_ZERO(d);

    free((*d)->d);
    free(*d);

    d = 0;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_a2905b59d4a364111890224a444fd6d30}{\index{common/measurement.\-c@{common/measurement.\-c}!delete\-Eta\-Function@{delete\-Eta\-Function}}
\index{delete\-Eta\-Function@{delete\-Eta\-Function}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{delete\-Eta\-Function}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf delete\-Eta\-Function} (
\begin{DoxyParamCaption}
\item[{{\bf \-Eta\-Function} $\ast$}]{eta}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a2905b59d4a364111890224a444fd6d30}


deletes an \-Eta\-Function and sets the pointer to zero 


\begin{DoxyParams}{\-Parameters}
{\em eta} & \\
\hline
\end{DoxyParams}


\-Definition at line 62 of file measurement.\-c.



\-References \-R\-E\-T\-U\-R\-N\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O.



\-Referenced by main().


\begin{DoxyCode}
{
    RETURN_IF_ZERO(eta);
    RETURN_IF_ZERO(*eta);

    free((*eta)->C);
    free((*eta)->eta);
    free(*eta);

    *eta = 0;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_ae9d17380c2a4280b6760d9d917dfb573}{\index{common/measurement.\-c@{common/measurement.\-c}!delete\-Log\-Cache@{delete\-Log\-Cache}}
\index{delete\-Log\-Cache@{delete\-Log\-Cache}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{delete\-Log\-Cache}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf delete\-Log\-Cache} (
\begin{DoxyParamCaption}
\item[{{\bf \-Log\-Cache} $\ast$}]{log\-\_\-c}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_ae9d17380c2a4280b6760d9d917dfb573}


deletes a \-Log\-Cache and sets its pointer to zero 


\begin{DoxyParams}{\-Parameters}
{\em log\-\_\-c} & \\
\hline
\end{DoxyParams}


\-Definition at line 221 of file measurement.\-c.



\-References \-R\-E\-T\-U\-R\-N\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O.



\-Referenced by main().


\begin{DoxyCode}
{
    RETURN_IF_ZERO(log_c);
    RETURN_IF_ZERO(*log_c);

    free((*log_c)->logC);
    free((*log_c)->logNotC);
    free(*log_c);

    *log_c = 0;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_a8df411530d5811c51cb675a64547eed9}{\index{common/measurement.\-c@{common/measurement.\-c}!log\-Probability\-From\-Product@{log\-Probability\-From\-Product}}
\index{log\-Probability\-From\-Product@{log\-Probability\-From\-Product}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{log\-Probability\-From\-Product}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Log\-Probability} {\bf log\-Probability\-From\-Product} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Log\-Cache}}]{log\-\_\-c, }
\item[{{\bf \-Commutative\-Product}}]{l}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a8df411530d5811c51cb675a64547eed9}


calculate the log probability from a power vector 


\begin{DoxyParams}{\-Parameters}
{\em log\-\_\-c} & logarithms of constants \\
\hline
{\em l} & vector of constant and complementary powers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
the log probability of the product given by the vector of powers, l 
\end{DoxyReturn}


\-Definition at line 261 of file measurement.\-c.



\-References s\-Commutative\-Product\-::constants, s\-Log\-Cache\-::constants, s\-Commutative\-Product\-::intermediate, \-L\-O\-G\-\_\-\-P\-R\-O\-B\-\_\-\-L\-O\-W\-E\-R\-\_\-\-B\-O\-U\-N\-D, \-L\-O\-G\-\_\-\-P\-R\-O\-B\-\_\-\-U\-P\-P\-E\-R\-\_\-\-B\-O\-U\-N\-D, s\-Log\-Cache\-::log\-C, s\-Log\-Cache\-::log\-Not\-C, s\-Commutative\-Product\-::match, s\-Commutative\-Product\-::mismatch, \-R\-E\-T\-U\-R\-N\-\_\-\-Z\-E\-R\-O\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O, sum\-Up(), and \-W\-A\-R\-N\-\_\-\-I\-F\-\_\-\-U\-N\-E\-Q\-U\-A\-L\-\_\-\-D\-O.



\-Referenced by new\-Distance\-Matrix\-From\-Context(), optimize\-Approximation\-Context(), and optimize\-Condition\-Map().


\begin{DoxyCode}
{
    RETURN_ZERO_IF_ZERO(log_c);
    RETURN_ZERO_IF_ZERO(l);

    WARN_IF_UNEQUAL_DO(log_c->constants, l->constants, return 0);
    size_t constants = log_c->constants;

    for (size_t c = 0; c < constants; ++c)
    {
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
        /*
         * 0*-inf is still -inf; but we want to enforce 0*-inf = 0
         */
        if (l->match[c] > 0)
            l->intermediate[c] = log_c->logNotC[c]
                    * (LogProbability) l->match[c];
        else
            l->intermediate[c] = 0.;

        if (l->mismatch[c] > 0)
            l->intermediate[c + constants] = log_c->logC[c]
                    * (LogProbability) l->mismatch[c];
        else
            l->intermediate[c + constants] = 0.;
#pragma GCC diagnostic pop
    }

    return sumUp(l->intermediate, constants * 2, LOG_PROB_LOWER_BOUND,
    LOG_PROB_UPPER_BOUND);
}
\end{DoxyCode}


\-Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{common_2measurement_8c_a8df411530d5811c51cb675a64547eed9_cgraph}
\end{center}
\end{figure}


\hypertarget{common_2measurement_8c_abe35a2e2ccf6060635d4daf6d6ebf59e}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-Commutative\-Product@{new\-Commutative\-Product}}
\index{new\-Commutative\-Product@{new\-Commutative\-Product}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-Commutative\-Product}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Commutative\-Product} {\bf new\-Commutative\-Product} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{constants}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_abe35a2e2ccf6060635d4daf6d6ebf59e}


creates a new commutative product without any factors 


\begin{DoxyParams}{\-Parameters}
{\em constants} & number of formal constants \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
new \-Commutative\-Product object 
\end{DoxyReturn}


\-Definition at line 126 of file measurement.\-c.



\-References s\-Commutative\-Product\-::constants, s\-Commutative\-Product\-::intermediate, s\-Commutative\-Product\-::match, s\-Commutative\-Product\-::mismatch, and \-R\-E\-T\-U\-R\-N\-\_\-\-Z\-E\-R\-O\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O\-I.



\-Referenced by new\-Distance\-Matrix\-From\-Context(), optimize\-Approximation\-Context(), and optimize\-Condition\-Map().


\begin{DoxyCode}
{
    RETURN_ZERO_IF_ZEROI(constants);

    CommutativeProduct p;
    p = malloc(sizeof(struct sCommutativeProduct));

    p->constants = constants;

    p->mismatch = calloc(constants, sizeof(size_t));
    p->match = calloc(constants, sizeof(size_t));

    p->intermediate = malloc(constants * 2 * sizeof(LogProbability));

    return p;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_ac4b7705e5a5c82b5d59b67617e6f2dc4}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-Condition\-Map@{new\-Condition\-Map}}
\index{new\-Condition\-Map@{new\-Condition\-Map}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-Condition\-Map}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Condition\-Map} {\bf new\-Condition\-Map} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{objects}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_ac4b7705e5a5c82b5d59b67617e6f2dc4}


creates a new condition map 


\begin{DoxyParams}{\-Parameters}
{\em objects} & cardinality of the domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
new \-Condition\-Map object 
\end{DoxyReturn}


\-Definition at line 168 of file measurement.\-c.



\-References s\-Condition\-Map\-::c, s\-Condition\-Map\-::objects, and \-R\-E\-T\-U\-R\-N\-\_\-\-Z\-E\-R\-O\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O\-I.



\-Referenced by main(), and new\-Fake\-Measurement().


\begin{DoxyCode}
{
    RETURN_ZERO_IF_ZEROI(objects);

    ConditionMap c;
    c = malloc(sizeof(struct sConditionMap));

    c->objects = objects;
    c->c = calloc(objects, sizeof(size_t));

    return c;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_ae6570aaa925f8a9155f9385de467dcbd}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-Distance\-Matrix@{new\-Distance\-Matrix}}
\index{new\-Distance\-Matrix@{new\-Distance\-Matrix}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-Distance\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Distance\-Matrix} {\bf new\-Distance\-Matrix} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{objects}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_ae6570aaa925f8a9155f9385de467dcbd}


creates a new \-Distance\-Matrix of the given size 


\begin{DoxyParams}{\-Parameters}
{\em objects} & square matrix dimension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
the new \-Distance\-Matrix object 
\end{DoxyReturn}


\-Definition at line 336 of file measurement.\-c.



\-References s\-Distance\-Matrix\-::d, s\-Distance\-Matrix\-::objects, and \-R\-E\-T\-U\-R\-N\-\_\-\-Z\-E\-R\-O\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O\-I.



\-Referenced by new\-Distance\-Matrix\-From\-Context().


\begin{DoxyCode}
{
    RETURN_ZERO_IF_ZEROI(objects);

    DistanceMatrix d;

    d = malloc(sizeof(struct sDistanceMatrix));

    d->objects = objects;

    d->d = calloc(objects * objects, sizeof(LogProbability));

    return d;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_aa0f12091b86c478e159761719923bd9a}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-Eta\-Function@{new\-Eta\-Function}}
\index{new\-Eta\-Function@{new\-Eta\-Function}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-Eta\-Function}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Eta\-Function} {\bf new\-Eta\-Function} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{types, }
\item[{size\-\_\-t}]{measurements, }
\item[{size\-\_\-t}]{constants}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_aa0f12091b86c478e159761719923bd9a}


creates a new \-Eta\-Function 


\begin{DoxyParams}{\-Parameters}
{\em types} & number of types, usually 2 \\
\hline
{\em measurements} & number of different measurements, \\
\hline
{\em constants} & number of different error constants, $<$= types$\ast$measurements are needed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a new structure 
\end{DoxyReturn}


\-Definition at line 38 of file measurement.\-c.



\-References s\-Eta\-Function\-::\-C, s\-Eta\-Function\-::constants, s\-Eta\-Function\-::eta, s\-Eta\-Function\-::measurements, \-R\-E\-T\-U\-R\-N\-\_\-\-Z\-E\-R\-O\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O\-I, and s\-Eta\-Function\-::types.



\-Referenced by new\-General\-Eta\-Function(), and new\-Uniform\-Eta\-Function().


\begin{DoxyCode}
{
    RETURN_ZERO_IF_ZEROI(types);
    RETURN_ZERO_IF_ZEROI(measurements);
    RETURN_ZERO_IF_ZEROI(constants);

    EtaFunction e;
    e = malloc(sizeof(struct sEtaFunction));

    e->types = types;
    e->measurements = measurements;
    e->constants = constants;

    e->C = calloc(constants, sizeof(Probability));
    e->eta = calloc(types * measurements, sizeof(size_t));

    return e;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_a018a3a7d15c126cbf15d03ba2698fe39}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-General\-Eta\-Function@{new\-General\-Eta\-Function}}
\index{new\-General\-Eta\-Function@{new\-General\-Eta\-Function}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-General\-Eta\-Function}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Eta\-Function} {\bf new\-General\-Eta\-Function} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{types, }
\item[{size\-\_\-t}]{measurements}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a018a3a7d15c126cbf15d03ba2698fe39}


create a new \-Eta\-Function with the a constant for each type and measurement on its own 


\begin{DoxyParams}{\-Parameters}
{\em types} & \\
\hline
{\em measurements} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}

\end{DoxyReturn}


\-Definition at line 104 of file measurement.\-c.



\-References s\-Eta\-Function\-::eta, and new\-Eta\-Function().


\begin{DoxyCode}
{
    EtaFunction e;
    e = newEtaFunction(types, measurements, types * measurements);

    for (size_t t = 0; t < types; ++t)
    {
        for (size_t m = 0; m < measurements; ++m)
        {
            e->eta[t * measurements + m] = t * measurements + m;
        }
    }

    return e;
}
\end{DoxyCode}


\-Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{common_2measurement_8c_a018a3a7d15c126cbf15d03ba2698fe39_cgraph}
\end{center}
\end{figure}


\hypertarget{common_2measurement_8c_a25fcd9b89607eaa3abe03aea6ffe0447}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-Log\-Cache@{new\-Log\-Cache}}
\index{new\-Log\-Cache@{new\-Log\-Cache}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-Log\-Cache}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Log\-Cache} {\bf new\-Log\-Cache} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{constants}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a25fcd9b89607eaa3abe03aea6ffe0447}


creates a new cache for logs of constants 


\begin{DoxyParams}{\-Parameters}
{\em constants} & number of constants \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
new \-Log\-Cache 
\end{DoxyReturn}


\-Definition at line 203 of file measurement.\-c.



\-References s\-Log\-Cache\-::constants, s\-Log\-Cache\-::log\-C, and s\-Log\-Cache\-::log\-Not\-C.



\-Referenced by main().


\begin{DoxyCode}
{
    LogCache l;

    l = malloc(sizeof(struct sLogCache));

    l->constants = constants;

    l->logC = calloc(constants, sizeof(LogProbability));
    l->logNotC = calloc(constants, sizeof(LogProbability));

    return l;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_a48c795067056a496c8e4aa903fac7d71}{\index{common/measurement.\-c@{common/measurement.\-c}!new\-Uniform\-Eta\-Function@{new\-Uniform\-Eta\-Function}}
\index{new\-Uniform\-Eta\-Function@{new\-Uniform\-Eta\-Function}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{new\-Uniform\-Eta\-Function}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Eta\-Function} {\bf new\-Uniform\-Eta\-Function} (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{types, }
\item[{size\-\_\-t}]{measurements}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a48c795067056a496c8e4aa903fac7d71}


create a new \-Eta\-Function with the same constant for each type 


\begin{DoxyParams}{\-Parameters}
{\em types} & \\
\hline
{\em measurements} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}

\end{DoxyReturn}


\-Definition at line 81 of file measurement.\-c.



\-References s\-Eta\-Function\-::eta, and new\-Eta\-Function().



\-Referenced by main().


\begin{DoxyCode}
{
    EtaFunction e;
    e = newEtaFunction(types, measurements, types);

    for (size_t t = 0; t < types; ++t)
    {
        for (size_t m = 0; m < measurements; ++m)
        {
            e->eta[t * measurements + m] = t;
        }
    }

    return e;
}
\end{DoxyCode}


\-Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{common_2measurement_8c_a48c795067056a496c8e4aa903fac7d71_cgraph}
\end{center}
\end{figure}


\hypertarget{common_2measurement_8c_a6ec39ef8a7180bc340afed87c57ca604}{\index{common/measurement.\-c@{common/measurement.\-c}!sum\-Up@{sum\-Up}}
\index{sum\-Up@{sum\-Up}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{sum\-Up}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Log\-Probability} {\bf sum\-Up} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Log\-Probability} $\ast$restrict}]{\-V, }
\item[{size\-\_\-t}]{length, }
\item[{{\bf \-Log\-Probability}}]{lower\-\_\-bound, }
\item[{{\bf \-Log\-Probability}}]{upper\-\_\-bound}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_a6ec39ef8a7180bc340afed87c57ca604}


\-This routine calculates the sum of elements of a vector. 


\begin{DoxyParams}{\-Parameters}
{\em \-V} & ptr to array of \-Log\-Probabilities \\
\hline
{\em length} & length of array \-V \\
\hline
{\em lower\-\_\-bound} & lower bound to include in this sum \\
\hline
{\em upper\-\_\-bound} & upper bound to include in this sum \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\[ \sum_{i=0, \mathrm{lower\_bound}\leq V(i) < \mathrm{upper\_bound}}^{ \mathrm{length}} V(i) \] 
\end{DoxyReturn}


\-Definition at line 305 of file measurement.\-c.



\-Referenced by log\-Probability\-From\-Product().


\begin{DoxyCode}
{
    //TODO: Make this routine smarter with respect to LARGE sums

    LogProbability sum;
    sum = 0.;

    for (size_t i = 0; i < length; ++i)
    {
        LogProbability summand;
        summand = V[i];

        if ((lower_bound <= summand) && (summand < upper_bound))
        {
            //printf("+%.2f",summand);
            sum += summand;
        }
    }
    //printf("=");

    return sum;
}
\end{DoxyCode}
\hypertarget{common_2measurement_8c_ad54d95f7de71efa2ad16ce6b133cf439}{\index{common/measurement.\-c@{common/measurement.\-c}!write\-Distances\-To\-File@{write\-Distances\-To\-File}}
\index{write\-Distances\-To\-File@{write\-Distances\-To\-File}!common/measurement.c@{common/measurement.\-c}}
\subsubsection[{write\-Distances\-To\-File}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf write\-Distances\-To\-File} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Distance\-Matrix}}]{d, }
\item[{const char $\ast$}]{filename}
\end{DoxyParamCaption}
)}}\label{common_2measurement_8c_ad54d95f7de71efa2ad16ce6b133cf439}


\-Writes the contents of a distance matrix to the given file in \-C\-S\-V format\-: d(x,y) will be written on the (x+1)th line to the (y+1)th column. 


\begin{DoxyParams}{\-Parameters}
{\em d} & the distance matrix \\
\hline
{\em filename} & output file name \\
\hline
\end{DoxyParams}


\-Definition at line 375 of file measurement.\-c.



\-References s\-Distance\-Matrix\-::d, s\-Distance\-Matrix\-::objects, and \-R\-E\-T\-U\-R\-N\-\_\-\-I\-F\-\_\-\-Z\-E\-R\-O.



\-Referenced by main().


\begin{DoxyCode}
{
    RETURN_IF_ZERO(d);
    RETURN_IF_ZERO(filename);

    FILE* file;
    file = fopen(filename, "w");

    RETURN_IF_ZERO(file);

    /*
     * header row
     */

    fputs("\"d(x,y)\"", file);

    for (size_t y = 0; y < d->objects; ++y)
    {
        fprintf(file, ",y=%zu", y);
    }

    fputs("\n", file);

    /*
     * contents
     */

    for (size_t x = 0; x < d->objects; ++x)
    {
        fprintf(file, "x=%zu", x);

        for (size_t y = 0; y < d->objects; ++y)
        {
            fprintf(file, ",%f", d->d[x * d->objects + y]);
        }

        fputs("\n", file);
    }

    fclose(file);
}
\end{DoxyCode}
